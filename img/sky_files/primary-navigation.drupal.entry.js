import"./chunks/to-object-b8d98adc.js";import"./chunks/web.url-e01eb991.js";import"./chunks/es.regexp.to-string-5800115b.js";import"./chunks/_rollupPluginBabelHelpers-614f59f6.js";import"./chunks/es.string.replace-8efccc2c.js";import{m as e,K as t}from"./chunks/utils.es6-02255307.js";import"./chunks/es.string.trim-c73b0748.js";import"./chunks/create-property-7417731d.js";class MainNavigation{constructor(e,t="nav",s="(max-width: 720px)",i=!0,a="a",r="span",n=150){this.nav=e,this.nav&&this.nav.nodeType&&(this.navPrefix=t,this.hasSubNavClass=`${this.navPrefix}__has-subnav`,this.subNavToggleClass=`${this.navPrefix}__toggle`,this.openClass=`${this.navPrefix}--open`,this.reverseClass=`${this.navPrefix}--reverse`,this.level3Class=`${this.navPrefix}__level-3`,this.mediaBreakpoint=s,this.breakpoint=window.matchMedia(this.mediaBreakpoint),this.navLinks=this.nav.querySelectorAll("a"),this.shouldSetHeight=i,this.toggleType=a,this.mobileToggleType=r,this.delay=n,this.handleToggle=this.handleToggle.bind(this),this.handleKeyPress=this.handleKeyPress.bind(this),this.init())}init(){if(!this.nav||!this.nav.nodeType)return;const{hasSubNavClass:s,subNavToggleClass:i}=this;this.subNavItems=this.nav.querySelectorAll(`.${s}`),this.subNavToggles=this.nav.querySelectorAll(`.${i}`),this.responsiveCheck(this.breakpoint),this.breakpoint.addListener((e=>this.responsiveCheck(e))),this.navLinks.forEach((e=>{e.addEventListener("keydown",this.handleKeyPress),e.addEventListener("touchend",(e=>this.handleTouch(e)))})),this.subNavItems.forEach(((t,s)=>{const i=t.querySelector("a"),a=t.querySelector("ul");if(a){const t=a.id||e(`subnav-${s}-${i.textContent}`,30);a.setAttribute("id",t)}})),this.keyboard=new t,this.keyboard.attachEventListeners(),this.nav.addEventListener("focusin",(()=>{this.keyboard.attachMenu(this,this.navLinks)})),this.nav.addEventListener("focusout",(()=>{this.keyboard.detachMenu()}))}responsiveCheck({matches:e}){e?(this.attachMobileNav(),this.detachDesktopNav()):(this.detachMobileNav(),this.attachDesktopNav())}attachMobileNav(){this.subNavItems.forEach((e=>{MainNavigation.setAria(e,this.mobileToggleType)})),this.subNavToggles.forEach((e=>{e.addEventListener("click",this.handleToggle),e.addEventListener("keydown",this.handleKeyPress)}))}detachMobileNav(){this.subNavItems.forEach((e=>{MainNavigation.removeAria(e,this.mobileToggleType)})),this.subNavToggles.forEach((e=>{e.removeEventListener("click",this.handleToggle),e.removeEventListener("keydown",this.handleKeyPress)}))}attachDesktopNav(){this.subNavItems.forEach((e=>{e.addEventListener("mouseenter",this.handleToggle),e.addEventListener("mouseleave",this.handleToggle),e.addEventListener("touchend",this.handleToggle),this.setOrientation(e),MainNavigation.setAria(e,this.toggleType)}))}detachDesktopNav(){this.subNavItems.forEach((e=>{e.removeEventListener("mouseenter",this.handleToggle),e.removeEventListener("mouseleave",this.handleToggle),MainNavigation.removeAria(e,this.toggleType)}))}handleToggle(e){let t=e.currentTarget;"LI"!==t.tagName&&(t=t.parentElement);const s=t.querySelector("ul");s&&("mouseenter"!==e.type?"mouseleave"!==e.type?s.classList.contains(this.openClass)?this.closeLevel(t):("touchend"===e.type&&(e.preventDefault(),e.stopPropagation()),this.openLevel(t)):setTimeout((()=>this.closeLevel(t)),this.delay):this.openLevel(t))}openLevel(e){const t=e.querySelector("ul"),{openClass:s}=this,{id:i}=t,a=e.querySelector(`[aria-controls="${i}"]`);e.classList.add(s),a.setAttribute("aria-expanded","true"),t.setAttribute("aria-hidden","false"),t.classList.add(s),e.querySelectorAll(`.${this.openClass} > li > a`).forEach((e=>{e.setAttribute("tabindex","0")})),this.shouldSetHeight&&this.setHeight(e)}closeLevel(e){const t=e.querySelector("ul"),{openClass:s}=this,{id:i}=t,a=e.querySelector(`[aria-controls="${i}"]`);e.classList.remove(s),t.setAttribute("aria-hidden","true"),a.setAttribute("aria-expanded","false"),t.classList.remove(s),t.querySelectorAll("a").forEach((e=>{e.setAttribute("tabindex","-1")})),this.shouldSetHeight&&MainNavigation.removeHeight(e)}setOrientation(e){const{reverseClass:t}=this,s=e.querySelector("ul");if(!s)return;let i=0;s.getBoundingClientRect()&&(i=s.getBoundingClientRect().right),window.innerWidth<i&&s.classList.add(t),s.querySelectorAll("ul").forEach((e=>{if(e&&e.getBoundingClientRect()){const i=e.getBoundingClientRect().right;window.innerWidth<i&&s.classList.add(t)}}))}setHeight(e){const t=e.querySelector("ul");if(t&&!this.breakpoint.matches&&t.classList.contains(this.level3Class)){const e=t.parentElement.closest("ul"),s=t.getBoundingClientRect().height;e.style.height=`${s}px`}}static removeHeight(e){const t=e.querySelector("ul");t&&(t.style.removeProperty("height"),t.removeAttribute("style"))}static setAria(e,t){const s=e.querySelector("ul"),i=e.querySelector(t);i&&s&&s.hasAttribute("id")&&(i.setAttribute("aria-expanded","false"),i.setAttribute("aria-haspopup","true"),i.setAttribute("aria-controls",s.id)),s&&(s.setAttribute("aria-hidden","true"),s.querySelectorAll("a").forEach((e=>{e.setAttribute("tabindex","-1")}))),i&&"span"===t&&i.setAttribute("tabindex","0")}static removeAria(e,t){const s=e.querySelector(t);s&&(s.removeAttribute("aria-expanded"),s.removeAttribute("aria-haspopup"),s.removeAttribute("aria-controls"),"span"===t&&s.removeAttribute("tabindex"))}handleKeyPress(e){let t=e.currentTarget;"LI"!==t.tagName&&(t=t.parentElement);const s=t.parentNode;if(t===s.firstElementChild&&s.id&&("Tab"===e.key&&!0===e.shiftKey||"ArrowUp"===e.key))return this.closeLevel(s.parentNode),void s.querySelector("a").focus();if(t===s.lastElementChild&&s.id&&("Tab"===e.key&&!1===e.shiftKey||"ArrowDown"===e.key))return this.closeLevel(s.parentNode),void s.querySelector("a").focus();const i=t.querySelector("ul");if(!i)return;const a=i.querySelectorAll("a");switch(e.key){case"Enter":case" ":case"Down":case"ArrowDown":e.preventDefault(),e.stopPropagation(),this.openLevel(t),a[0].focus();break;case"Up":case"ArrowUp":e.preventDefault(),e.stopPropagation(),this.openLevel(t),a[a.length-1].focus()}}handleTouch(e){if(this.breakpoint.matches)return;const t=e.target.closest("li");!t.classList.contains(this.hasSubNavClass)||t.classList.contains(this.openClass)?window.location=e.target.href:this.closeSiblings(t)}closeSiblings(e){e.closest("ul").querySelectorAll(`.${this.hasSubNavClass}`).forEach((e=>{this.closeLevel(e)}))}}class CDUMainNavigation extends MainNavigation{constructor(e){super(e),this.reversedLinkClass=`${this.navPrefix}__has-reverse-subnav`,this.reversedLinks=this.nav.querySelectorAll(`.${this.reversedLinkClass}`),this.reversedLinks.forEach((e=>{const t=e.nextElementSibling;t&&(t.classList.add(this.reverseClass),t.querySelectorAll("ul").forEach((()=>{t.classList.add(this.reverseClass)})))}))}}(({behaviors:e})=>{e.cdu_primaryNavigation={attach:e=>{e.querySelectorAll(".nav--dropdown").forEach((e=>{new CDUMainNavigation(e).init()}))}}})(Drupal);
